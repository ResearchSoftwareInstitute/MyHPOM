{% extends 'myhpom/includes/upload_base.html' %}
{% load sass_tags static %}

{% block widget_breadcrumb_items %}
    <li class="advance-directive-widget__breadcrumb-item breadcrumb-item--selected">
        Select Document
    </li>
    <li class="advance-directive-widget__breadcrumb-item">
        Submit
    </li>
    <li class="advance-directive-widget__breadcrumb-item">
        Confirmation
    </li>
{% endblock widget_breadcrumb_items %}

{% block widget_body %}
	<form id="id_requirements__form" class="upload-requirements__form" method="POST">
		{% csrf_token %}
		<div class="upload-requirements__div">
			<h3 class="h6">ADVANCE DIRECTIVE DOCUMENT REQUIREMENTS FOR {{ user.userdetails.state.title|upper }}</h3>
			<ol class="upload-requirements__ol">
				{% for requirement in requirements %}
				<li class="upload-requirements__li">
					<input class="upload-requirements__checkbox" type="checkbox" id="id_requirement_{{ requirement.id }}" class="upload-requirements__checkbox"/>
					<label class="upload-requirements__label" for="id_requirement_{{ requirement.id }}">{{ requirement.text }}</label>
					<ol class="upload-requirements-link__ol">
						{% for link in requirement.staterequirementlink_set.all %}
						<li class="upload-requirements-link__li">
							<a href="{{ link.href }}" onClick="event.preventDefault();">{{ link.text }}</a>
						</li>
						{% endfor %}
					</ol>
				</li>
				{% endfor %}
			</ol>
		</div>

		<div class="upload-requirements__div">
			<h4 class="upload-requirements__h4">My file is valid starting:
				<a class="upload-requirements__a--right" href="" onClick="event.preventDefault();">What is this?</a>
			</h4>
			<input id="id_doc_date" name="doc_date" data-min-year="{{ MIN_YEAR }}" data-max-year="{{ MAX_YEAR }}"/> 
		</div>

		<div class="upload-requirements__div">
			<ol class="upload-requirements__ol">
				<li class="upload-requirements__li">
					<input type="checkbox" id="id_approval_checkbox" class="upload-requirements__checkbox"/>
					<label class="upload-requirements__label" for="id_approval_checkbox">I approve this file for storage</label>
					<ol class="upload-requirements-link__ol">
						<li class="upload-requirements-link__li">
							<a href="" onClick="event.preventDefault();">Review Terms and Conditions</a>
						</li>
					</ol>
				</li>
			</ol>
		</div>

		<div class="upload-requirements__div">
				<button type="button" class="btn btn-primary" id="id_button_select_file">
					SELECT FILE
				</button>
			</button>
		</div>

		<div class="upload-requirements__div">
			<a href="/dashboard">CANCEL</a>
		</div>
	</form>
</div>

<script type="text/javascript" src="{% static "myhpom/moment/min/moment.min.js" %}"></script>
<script type="text/javascript" src="{% static "myhpom/combodate-1.0.7/combodate.js" %}"></script>
<script>
    jQuery(function ($) {
        var $requirements = $('.upload-requirements__checkbox');
        var $selectFileButton = $('#id_button_select_file');
        var $docDate = $('#id_doc_date');

		function selectFileEnableDisable () {
			if ($('.upload-requirements__checkbox:checked').length == $requirements.length
				&& $docDate.combodate('getValue') != ''
			) {
	    		$selectFileButton.prop('disabled', null);
	    	} else {
	    		$selectFileButton.prop('disabled', 'disabled');
	    	}
		}

        $requirements.on('change', function (event) {
        	selectFileEnableDisable();
        });

        $requirements.trigger('change');

	    $docDate.combodate({
		    smartDays: true,
		    format: "YYYY-MM-DD",
		    template: "MMMM D YYYY"
		});

		$docDate.on('change', function (event) {
			selectFileEnableDisable();
		});
    });
</script>
{% endblock widget_body %}
